<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Subresource Integrity</title>
  <link href="default.css" rel="stylesheet" type="text/css">
  <link href="https://www.w3.org/StyleSheets/TR/W3C-CR" rel="stylesheet" type="text/css">
  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Subresource Integrity</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">W3C Candidate Recommendation, <time class="dt-updated" datetime="2015-11-03">3 November 2015</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://www.w3.org/TR/2015/CR-SRI-1-20151103/">http://www.w3.org/TR/2015/CR-SRI-1-20151103/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/SRI/">http://www.w3.org/TR/SRI/</a>
     <dt>Editor's Draft:
     <dd><a href="https://w3c.github.io/webappsec-subresource-integrity/">https://w3c.github.io/webappsec-subresource-integrity/</a>
     <dt>Previous Versions:
     <dd><a href="http://www.w3.org/TR/2015/WD-SRI-20151006/" rel="previous">http://www.w3.org/TR/2015/WD-SRI-20151006/</a>
     <dt>Version History:
     <dd><a href="https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages">https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BSRI%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[SRI] <i>… message topic …</i></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/metromoxie/webappsec-subresource-integrity/issues/">GitHub</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:dev.akhawe@gmail.com">Devdatta Akhawe</a> (<span class="p-org org">Dropbox Inc.</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="68466"><a class="p-name fn u-email email" href="mailto:fbraun@mozilla.com">Frederik Braun</a> (<span class="p-org org">Mozilla</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:francois@mozilla.com">Francois Marier</a> (<span class="p-org org">Mozilla</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jww@google.com">Joel Weinberger</a> (<span class="p-org org">Google Inc.</span>)
     <dt>Participate:
     <dd><span><a href="https://github.com/w3c/webappsec-subresource-integrity/issues/new">File a bug </a> (<a href="https://github.com/w3c/webappsec-subresource-integrity/issues">open issues</a>)</span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines a mechanism by which user agents may verify that a

fetched resource has been delivered without unexpected manipulation.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of
  its publication. Other documents may supersede this document. A list of
  current W3C publications and the latest revision of this technical report
  can be found in the <a href="http://www.w3.org/TR/">W3C technical reports
  index at http://www.w3.org/TR/.</a></em> </p>
   <p> This document was published by the <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a> as a Candidate Recommendation. This document is intended to become a W3C Recommendation.
  This document will remain a Candidate Recommendation at least until <time class="status-deadline" datetime="2015-12-15">15 December 2015</time> in order
  to ensure the opportunity for wide review. </p>
   <p> The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5BSRI%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “SRI” in the subject,
	preferably like this:
	“[SRI] <em>…summary of comment…</em>” </p>
   <p> Publication as a Candidate Recommendation does not imply endorsement by the W3C
  Membership. This is a draft document and may be updated, replaced or
  obsoleted by other documents at any time. It is inappropriate to cite this
  document as other than work in progress. </p>
   <p> The entrance criteria for this document to enter the Proposed Recommendation stage
  is to have a minimum of two independent and interoperable user agents that
  implement all the features of this specification, which will be determined by
  passing the user agent tests defined in the test suite developed by the Working
  Group. The Working Group will prepare an implementation report to track progress. </p>
   <p> This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a>
      <li>
       <a href="#examples"><span class="secno">1.2</span> <span class="content">Use Cases/Examples</span></a>
       <ul class="toc">
        <li><a href="#resource-integrity"><span class="secno">1.2.1</span> <span class="content">Resource Integrity</span></a>
       </ul>
     </ul>
    <li>
     <a href="#terms"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
     <ul class="toc">
      <li><a href="#grammar"><span class="secno">2.1</span> <span class="content">Grammatical Concepts</span></a>
     </ul>
    <li>
     <a href="#framework"><span class="secno">3</span> <span class="content">Framework</span></a>
     <ul class="toc">
      <li><a href="#metadata"><span class="secno">3.1</span> <span class="content">Integrity metadata</span></a>
      <li>
       <a href="#cryptographic-hash-functions"><span class="secno">3.2</span> <span class="content">Cryptographic hash functions</span></a>
       <ul class="toc">
        <li><a href="#agility"><span class="secno">3.2.1</span> <span class="content">Agility</span></a>
        <li><a href="#priority"><span class="secno">3.2.2</span> <span class="content">Priority</span></a>
       </ul>
     </ul>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ul>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
   </ul>
  </div>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em> This section is not normative.</em></p>
   <p>Sites and applications on the web are rarely composed of resources from only a
single origin. For example, authors pull scripts and styles from a wide variety
of services and content delivery networks, and must trust that the delivered
representation is, in fact, what they expected to load. If an attacker can trick
a user into downloading content from a hostile server (via DNS <a data-link-type="biblio" href="#biblio-rfc1035">[RFC1035]</a> poisoning, or other such means), the author has no recourse. Likewise, an
attacker who can replace the file on the Content Delivery Network (CDN) server
has the ability to inject arbitrary content.</p>
   <p>Delivering resources over a secure channel mitigates some of this risk: with TLS <a data-link-type="biblio" href="#biblio-tls">[TLS]</a>, <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6797#section-6.1">HTTP Strict Transport Security (HSTS) </a> <a data-link-type="biblio" href="#biblio-rfc6797">[RFC6797]</a>, and <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7469#section-1">Public Key Pinning</a> <a data-link-type="biblio" href="#biblio-rfc7469">[RFC7469]</a>, a user agent can be
fairly certain that it is indeed speaking with the server it believes it’s
talking to. These mechanisms, however, authenticate <em>only</em> the server, <em>not</em> the content. An attacker (or administrator) with access to the
server can manipulate content with impunity.  Ideally, authors would not only be
able to pin the keys of a server, but also pin the <em>content</em>, ensuring
that an exact representation of a resource, and <em>only</em> that
representation, loads and executes.</p>
   <p>This document specifies such a validation scheme, extending two HTML elements
with an <code>integrity</code> attribute that contains a cryptographic hash of
the representation of the resource the author expects to load. For instance, an
author may wish to load some framework from a shared server rather than hosting
it on their own origin. Specifying that the <em>expected</em> SHA-384 hash of <code>https://example.com/example-framework.js</code> is <code>Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7</code> means that the user agent can verify that the data it loads from that URL
matches that expected hash before executing the JavaScript it contains. This
integrity verification significantly reduces the risk that an attacker can
substitute malicious content.</p>
   <p>This example can be communicated to a user agent by adding the hash to a <code>script</code> element, like so:</p>
   <div class="example" id="example-2cf8cb15">
    <a class="self-link" href="#example-2cf8cb15"></a> 
<pre>&lt;script src="https://example.com/example-framework.js"
        integrity="sha384-Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7"
        crossorigin="anonymous">&lt;/script>
</pre>
   </div>
   <p>Scripts, of course, are not the only response type which would benefit from
integrity validation. The scheme specified here also applies to <code>link</code> and future versions of this specification are likely to expand
this coverage.</p>
   <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
   <ol>
    <li data-md="">
     <p>Compromise of a third-party service should not automatically mean
  compromise of every site which includes its scripts. Content authors
  will have a mechanism by which they can specify expectations for
  content they load, meaning for example that they could load a <em>specific</em> script, and not <em>any</em> script that happens to have a
  particular URL.</p>
    <li data-md="">
     <p>The verification mechanism should have error-reporting functionality which
  would inform the author that an invalid response was received.</p>
   </ol>
   <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Use Cases/Examples</span><a class="self-link" href="#examples"></a></h3>
   <h4 class="heading settled" data-level="1.2.1" id="resource-integrity"><span class="secno">1.2.1. </span><span class="content">Resource Integrity</span><a class="self-link" href="#resource-integrity"></a></h4>
   <ul>
    <li data-md="">
     <p>An author wishes to use a content delivery network to improve performance
  for globally-distributed users. It is important, however, to ensure that
  the CDN’s servers deliver <em>only</em> the code the author expects them to
  deliver. To mitigate the risk that a CDN compromise (or unexpectedly
  malicious behavior) would change that site in unfortunate ways, the
  following <a data-link-type="dfn" href="#integrity-metadata">integrity metadata</a> is added to the <code>link</code> element included on the page:</p>
     <div class="example" id="example-f65c13cd">
      <a class="self-link" href="#example-f65c13cd"></a> 
<pre>&lt;link rel="stylesheet" href="https://site53.example.net/style.css"
      integrity="sha384-+/M6kredJcxdsqkczBUjMLvqyHb1K/JThDXWsBVxMEeZHEaMKEOEct339VItX1zB"
      crossorigin="anonymous">
</pre>
     </div>
    <li data-md="">
     <p>An author wants to include JavaScript provided by a third-party
  analytics service. To ensure that only the code that has been carefully
  reviewed is executed, the author generates <a data-link-type="dfn" href="#integrity-metadata">integrity metadata</a> for
  the script, and adds it to the <code>script</code> element:</p>
     <div class="example" id="example-dbcf36cc">
      <a class="self-link" href="#example-dbcf36cc"></a> 
<pre>&lt;script src="https://analytics-r-us.example.com/v1.0/include.js"
        integrity="sha384-MBO5IDfYaE6c6Aao94oZrIOiC6CGiSN2n4QUbHNPhzk5Xhm0djZLQqTpL0HzTUxk"
        crossorigin="anonymous">&lt;/script>
</pre>
     </div>
    <li data-md="">
     <p>A user agent wishes to ensure that JavaScript code running in high-privilege
  HTML contexts (for example, a browser’s New Tab page) aren’t manipulated
  before display. <a data-link-type="dfn" href="#integrity-metadata">Integrity metadata</a> mitigates the risk that altered
  JavaScript will run in these pages' high-privilege contexts.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="terms"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#terms"></a></h2>
   <p>This section defines several terms used throughout the document.</p>
   <p>The term <dfn data-dfn-type="dfn" data-noexport="" id="digest">digest<a class="self-link" href="#digest"></a></dfn> refers to the <a data-link-type="dfn" href="#base64-encoding">base64
encoded</a> result of executing a cryptographic hash function on an arbitrary
block of data.</p>
   <p>The term <dfn data-dfn-type="dfn" data-noexport="" id="origin">origin<a class="self-link" href="#origin"></a></dfn> is defined in the Origin specification. <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a></p>
   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="representation-data">representation data<a class="self-link" href="#representation-data"></a></dfn> and <dfn data-dfn-type="dfn" data-noexport="" id="content-encoding">content encoding<a class="self-link" href="#content-encoding"></a></dfn> of a resource
are defined by <a href="https://tools.ietf.org/html/rfc7231#section-3">Section 3
of RFC 7231</a>. <a data-link-type="biblio" href="#biblio-rfc7231">[RFC7231]</a></p>
   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="base64-encoding">base64 encoding<a class="self-link" href="#base64-encoding"></a></dfn> is defined in <a href="https://tools.ietf.org/html/rfc4648#section-4">Section 4 of RFC
4648</a>. <a data-link-type="biblio" href="#biblio-rfc4648">[RFC4648]</a></p>
   <p><a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-256</a>, <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-384</a>, and <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-512</a> are part
of the <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-2</a> set of cryptographic hash functions defined by the
NIST. <a data-link-type="biblio" href="#biblio-sha2">[SHA2]</a></p>
   <h3 class="heading settled" data-level="2.1" id="grammar"><span class="secno">2.1. </span><span class="content">Grammatical Concepts</span><a class="self-link" href="#grammar"></a></h3>
    The Augmented Backus-Naur Form (ABNF) notation used in this document is
specified in RFC5234. <a data-link-type="biblio" href="#biblio-abnf">[ABNF]</a> 
   <p><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">Appendix B.1 of ABNF </a> defines <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1"><code>VCHAR</code></a> (printing characters). <a data-link-type="biblio" href="#biblio-abnf">[ABNF]</a></p>
   <p><dfn data-dfn-type="dfn" data-noexport="" id="wsp"><code>WSP</code><a class="self-link" href="#wsp"></a></dfn> are defined in the HTML 5 specification as <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#space-character"><code>White_Space
characters</code></a>. <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a></p>
   <h2 class="heading settled" data-level="3" id="framework"><span class="secno">3. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
   <p>The integrity verification mechanism specified here boils down to the process of
generating a sufficiently strong cryptographic digest for a resource, and
transmitting that digest to a user agent so that it may be used to verify the
response.</p>
   <h3 class="heading settled" data-level="3.1" id="metadata"><span class="secno">3.1. </span><span class="content">Integrity metadata</span><a class="self-link" href="#metadata"></a></h3>
   <p>To verify the integrity of a response, a user agent requires <dfn data-dfn-type="dfn" data-noexport="" id="integrity-metadata">integrity
metadata<a class="self-link" href="#integrity-metadata"></a></dfn> as part of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-integrity-metadata">request</a>. This metadata consists of the
following pieces of information:</p>
   <ul>
    <li data-md="">
     <p>cryptographic hash function ("<code>alg</code>")</p>
    <li data-md="">
     <p><a data-link-type="dfn" href="#digest">digest</a> ("<code>val</code>")</p>
    <li data-md="">
     <p>options ("<code>opt</code>")</p>
   </ul>
   <p>The hash function and digest MUST be provided in order to validate a
response’s integrity.</p>
   <div class="note" role="note"> At the moment, no options are defined. However, future versions of
the spec may define options, such as MIME types. <a data-link-type="biblio" href="#biblio-mime-types">[MIME-TYPES]</a> </div>
   <p>This metadata MUST be encoded in the same format as the <a data-link-type="dfn" href="http://www.w3.org/TR/CSP2#source-list-syntax"><code>hash-source</code></a> (without the single quotes) in <a data-link-type="biblio" href="#biblio-csp2">[CSP2]</a>.</p>
   <p>For example, given a script resource containing only the string <code>\"alert(\'Hello, world.\');\"</code>, an author might choose <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-384</a> as a hash
function. <code>H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO</code> is
the <a data-link-type="dfn" href="#base64-encoding">base64 encoded</a> <a data-link-type="dfn" href="#digest">digest</a> that results. This
can be encoded as follows:</p>
   <div class="example" id="example-da8c6097">
    <a class="self-link" href="#example-da8c6097"></a> 
<pre>sha384-H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO
</pre>
   </div>
   <div class="note" role="note">
     Digests may be generated using any number of utilities. <a href="https://openssl.org/">OpenSSL</a>, for example, is quite commonly
available. The example in this section is the result of the following command
line: 
<pre>echo -n "alert('Hello, world.');" | openssl dgst -sha384 -binary | openssl base64 -A
</pre>
   </div>
   <h3 class="heading settled" data-level="3.2" id="cryptographic-hash-functions"><span class="secno">3.2. </span><span class="content">Cryptographic hash functions</span><a class="self-link" href="#cryptographic-hash-functions"></a></h3>
   <p>Conformant user agents MUST support the <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-256</a>, <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-384</a>,
and <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-512</a> cryptographic hash functions for use as part of a
request’s <a data-link-type="dfn" href="#integrity-metadata">integrity metadata</a> and MAY support additional hash functions.</p>
   <p>User agents SHOULD refuse to support known-weak hashing functions like <a data-link-type="dfn" href="https://www.ietf.org/rfc/rfc1321.txt#">MD5</a> or <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-1</a> and SHOULD restrict supported hashing functions to
those known to be collision-resistant. Additionally, user agents SHOULD
re-evaluate their supported hash functions on a regular basis and deprecate
support for those functions that have become insecure. See
[#hash-collision-attacks].</p>
   <h4 class="heading settled" data-level="3.2.1" id="agility"><span class="secno">3.2.1. </span><span class="content">Agility</span><a class="self-link" href="#agility"></a></h4>
   <p>Multiple sets of <a data-link-type="dfn" href="#integrity-metadata">integrity metadata</a> may be associated with a single
resource in order to provide agility in the face of future cryptographic
discoveries.  For example, the resource described in the previous section may be
described by either of the following hash expressions:</p>
   <div class="example" id="example-9e091bdc">
    <a class="self-link" href="#example-9e091bdc"></a> 
<pre>sha384-dOTZf16X8p34q2/kYyEFm0jh89uTjikhnzjeLeF0FHsEaYKb1A1cv+Lyv4Hk8vHd
sha512-Q2bFTOhEALkN8hOms2FKTDLy7eugP2zFZ1T8LCvX42Fp3WoNr3bjZSAHeOsHrbV1Fu9/A0EzCinRE7Af1ofPrw==
</pre>
   </div>
   <p>Authors may choose to specify both, for example:</p>
   <div class="example" id="example-ffb16d19">
    <a class="self-link" href="#example-ffb16d19"></a> 
<pre>&lt;script src="hello_world.js"
   integrity="sha384-dOTZf16X8p34q2/kYyEFm0jh89uTjikhnzjeLeF0FHsEaYKb1A1cv+Lyv4Hk8vHd
              sha512-Q2bFTOhEALkN8hOms2FKTDLy7eugP2zFZ1T8LCvX42Fp3WoNr3bjZSAHeOsHrbV1Fu9/A0EzCinRE7Af1ofPrw=="
   crossorigin="anonymous">&lt;/script>
</pre>
   </div>
   <p>In this case, the user agent will choose the strongest hash function in the
list, and use that metadata to validate the response (as described below in the <a data-link-type="dfn" href="#parse-metadata">parse metadata</a> and <a data-link-type="dfn" href="#get-the-strongest-metadata-from-set">get the strongest metadata from set</a> algorithms).</p>
   <p>When a hash function is determined to be insecure, user agents SHOULD deprecate
and eventually remove support for integrity validation using the insecure hash
function. User agents MAY check the validity of responses using a digest based
on a deprecated function.</p>
   <p>To allow authors to switch to stronger hash functions without being held back by
older user agents, validation using unsupported hash functions acts like no
integrity value was provided (see the <a data-link-type="dfn" href="#does-response-match-metadatalist">Does response match metadataList</a> algorithm below).  Authors  are encouraged to use strong hash functions, and to
begin migrating to stronger hash functions as they become available.</p>
   <h4 class="heading settled" data-level="3.2.2" id="priority"><span class="secno">3.2.2. </span><span class="content">Priority</span><a class="self-link" href="#priority"></a></h4>
   <p>User agents must provide a mechanism for determining the relative priority of
two hash functions and return the empty string if the priority is equal. That
is, if a user agent implemented a function like <dfn data-dfn-type="dfn" data-noexport="" id="getprioritizedhashfunction">getPrioritizedHashFunction<a class="self-link" href="#getprioritizedhashfunction"></a></dfn>(a, b) it would return the hash function
the user agent considers the most collision-resistant.  For example, <code>getPrioritizedHashFunction('sha256', 'sha512')</code> would return <code>'sha512'</code> and <code>getPrioritizedHashFunction('sha256', 'sha256')</code> would return the empty string.</p>
   <div class="note" role="note"> The <a data-link-type="dfn" href="#getprioritizedhashfunction">getPrioritizedHashFunction</a> is an internal implementation detail.
  It is not an API that implementors provide to web applications. It is used in
  this document only to simplify the algorithm description. </div>
   <p><dfn data-dfn-type="dfn" data-noexport="" id="parse-metadata">parse metadata<a class="self-link" href="#parse-metadata"></a></dfn> <dfn data-dfn-type="dfn" data-noexport="" id="get-the-strongest-metadata-from-set">get the strongest metadata from set<a class="self-link" href="#get-the-strongest-metadata-from-set"></a></dfn> <dfn data-dfn-type="dfn" data-noexport="" id="does-response-match-metadatalist">does response match metadatalist<a class="self-link" href="#does-response-match-metadatalist"></a></dfn></p>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li><a href="#base64-encoding">base64 encoding</a><span>, in §2</span>
   <li><a href="#content-encoding">content encoding</a><span>, in §2</span>
   <li><a href="#digest">digest</a><span>, in §2</span>
   <li><a href="#does-response-match-metadatalist">does response match metadatalist</a><span>, in §3.2.2</span>
   <li><a href="#getprioritizedhashfunction">getPrioritizedHashFunction</a><span>, in §3.2.2</span>
   <li><a href="#get-the-strongest-metadata-from-set">get the strongest metadata from set</a><span>, in §3.2.2</span>
   <li><a href="#integrity-metadata">integrity
metadata</a><span>, in §3.1</span>
   <li><a href="#origin">origin</a><span>, in §2</span>
   <li><a href="#parse-metadata">parse metadata</a><span>, in §3.2.2</span>
   <li><a href="#representation-data">representation data</a><span>, in §2</span>
   <li><a href="#wsp">WSP</a><span>, in §2.1</span>
  </ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li>
    <a data-link-type="biblio" href="#biblio-abnf">[ABNF]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">vchar</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-csp2">[CSP2]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/CSP2#source-list-syntax">hash-source</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-integrity-metadata">request</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html5">[html5]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#space-character">white_space characters</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc1321">[rfc1321]</a> defines the following terms:
    <ul>
     <li><a href="https://www.ietf.org/rfc/rfc1321.txt#">md5</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc6797">[rfc6797]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6797#section-6.1">strict-transport-security</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc7469">[rfc7469]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7469#section-1">public key pinning</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-sha2">[SHA2]</a> defines the following terms:
    <ul>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-1</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-2</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-256</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-384</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-512</a>
    </ul>
  </ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-abnf"><a class="self-link" href="#biblio-abnf"></a>[ABNF]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-csp2"><a class="self-link" href="#biblio-csp2"></a>[CSP2]
   <dd>Mike West; Adam Barth; Daniel Veditz. <a href="http://www.w3.org/TR/CSP2/">Content Security Policy Level 2</a>. 21 July 2015. CR. URL: <a href="http://www.w3.org/TR/CSP2/">http://www.w3.org/TR/CSP2/</a>
   <dt id="biblio-fetch"><a class="self-link" href="#biblio-fetch"></a>[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-sha2"><a class="self-link" href="#biblio-sha2"></a>[SHA2]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4, Secure Hash Standard</a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-html5"><a class="self-link" href="#biblio-html5"></a>[HTML5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-rfc1321"><a class="self-link" href="#biblio-rfc1321"></a>[RFC1321]
   <dd>R. Rivest. <a href="https://tools.ietf.org/html/rfc1321">The MD5 Message-Digest Algorithm</a>. April 1992. Informational. URL: <a href="https://tools.ietf.org/html/rfc1321">https://tools.ietf.org/html/rfc1321</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc4648"><a class="self-link" href="#biblio-rfc4648"></a>[RFC4648]
   <dd>S. Josefsson. <a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>. October 2006. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
   <dt id="biblio-rfc6454"><a class="self-link" href="#biblio-rfc6454"></a>[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-rfc6797"><a class="self-link" href="#biblio-rfc6797"></a>[RFC6797]
   <dd>J. Hodges; C. Jackson; A. Barth. <a href="https://tools.ietf.org/html/rfc6797">HTTP Strict Transport Security (HSTS)</a>. November 2012. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6797">https://tools.ietf.org/html/rfc6797</a>
   <dt id="biblio-rfc7231"><a class="self-link" href="#biblio-rfc7231"></a>[RFC7231]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
   <dt id="biblio-rfc7469"><a class="self-link" href="#biblio-rfc7469"></a>[RFC7469]
   <dd>C. Evans; C. Palmer; R. Sleevi. <a href="https://tools.ietf.org/html/rfc7469">Public Key Pinning Extension for HTTP</a>. April 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7469">https://tools.ietf.org/html/rfc7469</a>
  </dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-mime-types"><a class="self-link" href="#biblio-mime-types"></a>[MIME-TYPES]
   <dd>N. Freed; N. Borenstein. <a href="https://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</a>. November 1996. Draft Standard. URL: <a href="https://tools.ietf.org/html/rfc2046">https://tools.ietf.org/html/rfc2046</a>
   <dt id="biblio-tls"><a class="self-link" href="#biblio-tls"></a>[TLS]
   <dd>T. Dierks; E. Rescorla. <a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>. August 2008. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5246">https://tools.ietf.org/html/rfc5246</a>
   <dt id="biblio-rfc1035"><a class="self-link" href="#biblio-rfc1035"></a>[RFC1035]
   <dd>P.V. Mockapetris. <a href="https://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>. November 1987. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc1035">https://tools.ietf.org/html/rfc1035</a>
  </dl>
 </body>
</html>